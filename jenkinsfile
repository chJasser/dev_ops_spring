pipeline {
    agent any
    environment {
        TAG = '1.0'
    }
    stages {
      
        stage('Build') {
            steps {
                sh 'mvn -Dmaven.test.skip=true clean package'
            }
        }


        stage('install') {
            steps {
                sh 'mvn  -Dmaven.test.skip=true clean install '

            }

        }
         stage('start container') {
            steps {
                echo 'start container'
                sh 'docker-compose up -d'
               
            }
        }
      stage('build_push_image') {
              steps {
                        script {
                              def dockerImage = docker.build("fakher14/tpachat")
                              docker.withRegistry('',dockerCredentials){
                                         dockerImage.push("latest")
                               }
                          }
              }
        }
       
       
       


    }
   

    }
